
<!doctype html>
<html lang="en">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
		integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

	<script src="https://kit.fontawesome.com/1b301a96ca.js" crossorigin="anonymous"></script>

	<style>
		svg.bi.bi-file-plus {
			color: #e6e6e6;
		}

		.site {
			max-width: 1920px;
			margin: auto;
			background-image: url("data:image/svg+xml,<svg width='200px' height='200px' viewBox='0 0 16 16' class='bi bi-file-plus' fill='%23e6e6e6' xmlns='http://www.w3.org/2000/svg'><path fill-rule='evenodd' d='M4 0h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H4z'/><path fill-rule='evenodd' d='M8 5.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V10a.5.5 0 0 1-1 0V8.5H6a.5.5 0 0 1 0-1h1.5V6a.5.5 0 0 1 .5-.5z'/></svg>" );
			background-repeat: no-repeat;
			background-position: 10px 10px;
		}

		.site.minus {
			background-image: url("data:image/svg+xml,<svg width='200px' height='200px' viewBox='0 0 16 16' class='bi bi-file-minus' fill='%23e6e6e6' xmlns='http://www.w3.org/2000/svg'>  <path fill-rule='evenodd' d='M4 0h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H4z'/>  <path fill-rule='evenodd' d='M5.5 8a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H6a.5.5 0 0 1-.5-.5z'/></svg>" );
		}

		.site.multiply {
			background-image: url("data:image/svg+xml,<svg width='200px' height='200px' viewBox='0 0 16 16' class='bi bi-file-excel' fill='%23e6e6e6' xmlns='http://www.w3.org/2000/svg'> <path fill-rule='evenodd' d='M4 0h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H4z'/> <path fill-rule='evenodd' d='M5.18 4.616a.5.5 0 0 1 .704.064L8 7.219l2.116-2.54a.5.5 0 1 1 .768.641L8.651 8l2.233 2.68a.5.5 0 0 1-.768.64L8 8.781l-2.116 2.54a.5.5 0 0 1-.768-.641L7.349 8 5.116 5.32a.5.5 0 0 1 .064-.704z'/> </svg>");
		}

		.site>.container {
			min-height: 500px;
			
		}

		.row.question {
			height: 100px;
		}

		p.label {
			margin-bottom: 5px;
    		font-size: 20px;
		}

		#levelLabel {
			margin-top: 30px;
		}

		.level .fas {
			font-size: 40px;
			color: #e9ecef;
		}

		.fa-check  {
			color: green;
			font-size: 40px;
		}

		.fa-check.empty {
			color: #e9ecef;
		}

		#question {
			font-size: 50px;
			margin-top: 10px;
		}

		.photo img {
			max-height: 200px;
		}

		.toast {
			position: absolute;
			top: 15px;
			right:15px;
		}

		.toast-header svg {
			margin-right: 10px;
			font-size: 16px;
			color: gold;
		}

		#feedback svg.bi-award-fill {
			color: gold;
		}

		footer {
			background-color: #f1c3d7;
		}

		#resetProgress {
			color: white;
		}

		</style>


	<title>Maths addition tables</title>
</head>

<body>
	<nav class="navbar navbar-expand-lg navbar-light bg-light">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
		  <span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarTogglerDemo01">
		  <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
			<li class="nav-item dropdown">
				<a class="nav-link dropdown-toggle" href="#" id="navbarAdding" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				  Adding(+)
				</a>
				<div class="dropdown-menu" aria-labelledby="navbarAdding">
				  <a class="dropdown-item" href="?mode=half-level">1-5 levels</a>
				  <a class="dropdown-item" href="?mode=full-level">1-10 levels</a>
				  <a class="dropdown-item" href="?mode=roblox-challenge">Roblox Challenge!</a>
				</div>
			  </li>
			  <li class="nav-item dropdown">
				<a class="nav-link dropdown-toggle" href="#" id="navbarSubstracting" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				  Substracting(-)
				</a>
				<div class="dropdown-menu" aria-labelledby="navbarSubstracting">
					<a class="dropdown-item" href="?mode=full-minus">1-10 levels</a>
					<a class="dropdown-item" href="?mode=ten-minus">10</a>
				</div>
			  </li>
			  <li class="nav-item dropdown">
				<a class="nav-link dropdown-toggle" href="#" id="navbarMultiply" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				  Multiply(x)
				</a>
				<div class="dropdown-menu" aria-labelledby="navbarMultiply">
					<a class="dropdown-item" href="?mode=full-multiply">1-10 levels</a>
					<a class="dropdown-item" href="?mode=half-multiply">1-5 levels</a>
					<a class="dropdown-item" href="?mode=challenge-multiply">Roblox Challenge</a>
				</div>
			  </li>
			  <li class="nav-item">
				<a class="nav-link btn btn-danger" id="resetProgress" href="javascript:void();">Reset progress</a>
			  </li>
		  </ul>
		</div>
	  </nav>
	<div class="site">
		
		<div class="container ">
			<div class="row question">
				<div id="question" class="col-lg-4 offset-lg-3 col-md-4 offset-md-4 col-sm-8">
					2 + 2 = ?
				</div>

				<div id="feedback" class="col-md-2 col-sm-4 ">
					<div class="alert alert-success" role="alert">
						<svg width="100%" height="100%" viewBox="0 0 16 16" class="bi bi-emoji-smile"
							fill="currentColor" xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd"
								d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
							<path fill-rule="evenodd"
								d="M4.285 9.567a.5.5 0 0 1 .683.183A3.498 3.498 0 0 0 8 11.5a3.498 3.498 0 0 0 3.032-1.75.5.5 0 1 1 .866.5A4.498 4.498 0 0 1 8 12.5a4.498 4.498 0 0 1-3.898-2.25.5.5 0 0 1 .183-.683z" />
							<path
								d="M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5zm4 0c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5z" />
						</svg>
						<svg width="100%" height="100%" viewBox="0 0 16 16" class="bi bi-award-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
							<path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
							<path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
						  </svg>
					</div>
					<div class="alert alert-danger" role="alert">
						<svg width="100%" height="100%" viewBox="0 0 16 16" class="bi bi-emoji-frown"
							fill="currentColor" xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd"
								d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
							<path fill-rule="evenodd"
								d="M4.285 12.433a.5.5 0 0 0 .683-.183A3.498 3.498 0 0 1 8 10.5c1.295 0 2.426.703 3.032 1.75a.5.5 0 0 0 .866-.5A4.498 4.498 0 0 0 8 9.5a4.5 4.5 0 0 0-3.898 2.25.5.5 0 0 0 .183.683z" />
							<path
								d="M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5zm4 0c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5z" />
						</svg>
					</div>
				</div>
			</div>
			<div class="row ">
				<div class="col-md-4 offset-md-3 col-sm-12">
					<div class="progress">
						<div class="progress-bar progress-bar-striped" role="progressbar" style="width: 0%"
							aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>
					</div>
				</div>
			</div>
			<div class="row ">
				<div class="col-lg-7 offset-lg-2 col-md-9 offset-md-1 col-sm-12">
					<p id="levelLabel" class="label">You are at level %s</p>
					<p class="level">
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
						<i class="fas fa-star"></i>
					</p>
				</div>
			</div>
			<div class="row ">
				<div class="col-md-6 offset-md-3 col-sm-12">
					<form>
						<div class="form-group">
							<label for="inResult">Type the result</label>
							<input type="number" class="form-control col-lg-3 col-md-4 col-sm-3" id="inResult" maxlength="2">
						</div>
					</form>
				</div>
			</div>
			<div class="row correct">
				<div class="col-md-6 offset-md-3">
					<p id="correctInRowLabel" class="label">You need %d correct answers in row to pass the level.</p>
					<p></p>
				</div>
			</div>
			<div class="row correctInLevel d-none">
				<div class="col-md-6 offset-md-3">
					<p id="correctInLevelLabel" class="label">You need %d correct answers in level to pass it.</p>
					<p></p>
				</div>
			</div>
			<div class="row">
				<div class="col-md-6 offset-md-3">
					<p>Questions: <span id="questionsNo">0</span></p>
					<p>Correct: <span id="correctNo">0</span></p>
					<p>Correct in row: <span id="correctInRowNo">0</span></p>
				</div>
			</div>
		</div>
		<footer class="container-fluid text-center">
				<p>Maths for kids by jszoja@gmail.com | v1.8</p>
		</footer>
	</div>

	<!-- Modal dialogs -->
	<div id="modalPassedLevel" class="modal" tabindex="-1" role="dialog">
		<div class="modal-dialog modal-dialog-centered" role="document">
		  <div class="modal-content">
			<div class="modal-header">
			  <h5 class="modal-title">Well done!</h5>
			  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			  </button>
			</div>
			<div class="modal-body">
				<div class="alert alert-success" role="alert">
					<p>Aww yeah, you successfully passed the maths table in that level!.</p>
					<p>Do you want to try the next level?</p>
					<p><a id="nextLevelBtn" href="javascript:void();" class="btn btn-primary">Next Level</a></p>
				</div>
			</div>
		  </div>
		</div>
	</div>
	<div id="modalPassedRobloxChallenge" class="modal" tabindex="-1" role="dialog">
		<div class="modal-dialog modal-dialog-centered" role="document">
		  <div class="modal-content">
			<div class="modal-header">
			  <h5 class="modal-title">Well done!</h5>
			  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			  </button>
			</div>
			<div class="modal-body">
				<div class="alert alert-success" role="alert">
					<p>Aww yeah, you successfully passed the Roblox Challenge!.</p>
					<p>You have been awarded 400 Robux!!!</p>
					<p><img
							src="data:image/jpeg;base64,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">
						<svg style="font-size: 200px; margin-left: 40px;" width="1em" height="1em"
							viewBox="0 0 16 16" class="bi bi-patch-check-fll" fill="currentColor"
							xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd"
								d="M10.067.87a2.89 2.89 0 0 0-4.134 0l-.622.638-.89-.011a2.89 2.89 0 0 0-2.924 2.924l.01.89-.636.622a2.89 2.89 0 0 0 0 4.134l.637.622-.011.89a2.89 2.89 0 0 0 2.924 2.924l.89-.01.622.636a2.89 2.89 0 0 0 4.134 0l.622-.637.89.011a2.89 2.89 0 0 0 2.924-2.924l-.01-.89.636-.622a2.89 2.89 0 0 0 0-4.134l-.637-.622.011-.89a2.89 2.89 0 0 0-2.924-2.924l-.89.01-.622-.636zm.287 5.984a.5.5 0 0 0-.708-.708L7 8.793 5.854 7.646a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3z" />
						</svg>
					</p>
				</div>
			</div>
		  </div>
		</div>
	</div>

	<!-- Toasts -->
	<div id="toastLevelCompleted" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
		<div class="toast-header">
		<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-award-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
			<path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
			<path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
		</svg>
		  <strong class="mr-auto">Way to go!</strong>
		  <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
			<span aria-hidden="true">&times;</span>
		  </button>
		</div>
		<div class="toast-body">
		  Level completed in %ds
		</div>
	  </div>
	  <div id="toastOnFire" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
		<div class="toast-header">
		<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-award-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
			<path d="M8 0l1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
			<path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
		</svg>
		  <strong class="mr-auto">You are on fire!</strong>
		  <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
			<span aria-hidden="true">&times;</span>
		  </button>
		</div>
		<div class="toast-body">
		  You got 3 answers with gold speed!
		</div>
	  </div>

	<!-- Optional JavaScript -->
	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
		integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
		integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
		crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
		integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
		crossorigin="anonymous"></script>
	<script src="https://unpkg.com/underscore@1.11.0/underscore-min.js" crossorigin="anonymous"></script>
		
	<script type="text/javascript">
		$(function () {
			$('.toast').toast({delay:2500});
			var game = {
				// generic config - non-resticted
				timeLimit: 3000,
				min1: 1,
				max1: 1,
				min2: 1,
				max2: 5,
				passRateInRow: 6,
				passRateCorrect: 10,
				logAnswers: true,
				mode: 'full-level',
				answerDebounce: 400,
				goldAnswerSpeed: 1.25,
				// number of last questions to remember and prevent asking twice
				rememberedQuestionsCount: 5,

				// levels config
				availableModes: [ 'roblox-challenge', 'full-level', 'half-level', 'ten-minus', 'full-minus', 'full-multiply','half-multiply', 'challenge-multiply' ],
				singleLevelModes: [ 'half-level', 'full-level', 'ten-minus', 'full-minus', 'full-multiply','half-multiply' ],
				fullLevelModes: [ 'roblox-challenge', 'full-level', 'ten-minus', 'full-minus', 'full-multiply','challenge-multiply' ],
				challengeModes: ['roblox-challenge','challenge-multiply'],

				// wording
				levelLabelTxt: 'You are at level %s',
				correctInRowTxt: 'You need %d correct answers in row to pass the level.',
				correctInLevelTxt: 'You need %d correct answers in level to pass it.',
				levelCompletedToastTxt: 'Level completed in %ds',

				// advance config - restricted for dev - better leave
				level: 10,
				question: "2 + 2 = ?",
				askedQuestions: 0,
				correct: 0,
				interval: null,
				questionEl: null,
				resultInput: null,
				answerBtn: null,
				correctNoEl: null,
				questionsNoEl: null,
				number1: null,
				number2: null,
				expectedAnswer: null,
				correctInRowEl: null,
				correctInRow: 0,
				correctInLevel: 0,
				lastQuestions: [],
				timer: 0.0,
				progressTick: 100,
				answered: false,
				nextQuestionInterval: null,
				customLevel: false,
				failed: false,
				stopped: false,
				questionsPool: [],
				singleLevelMode: true,
				fullLevelMode: true,
				lastAnswerTime: 0.0,
				answerTimeStart: null,
				goldAnswersInRow: 0,
				levelTimer: 0.0,
				mathOperator: '+',

				init: function () {
					this.questionEl = $('#question');
					this.resultInput = $('#inResult');
					this.answerBtn = $('#answer');
					this.correctNoEl = $('#correctNo');
					this.questionsNoEl = $('#questionsNo');
					this.correctInRowEl = $('#correctInRowNo');
					this.feedbackEl = $('#feedback');
					this.progressEl = $('.progress-bar');

					//this.answerBtn.on( 'click', function(event){ event.preventDefault(); game.onAnswer(e); });
					$('form').on('submit', function (event) { event.preventDefault(); /*game.onAnswer(event);*/ })


					this.resultInput.on('keyup', game.debounce(
						function (event) { game.onAnswer(); },
						this.answerDebounce, false, 2

					));

					$(document).on('keyup', function(event) {
						if( event.which == 27 ) {
							game.toggle();
						}
					});

					
					var urlParams = new URLSearchParams(window.location.search);
					if (urlParams.has('mode')) {
						var mode = urlParams.get('mode');
						if ( this.availableModes.indexOf(this.mode) != -1) {
							this.mode = mode;
						}
					} 
					
					// level modes setup
					this.singleLevelMode = this.singleLevelModes.indexOf(this.mode) != -1;
					this.fullLevelMode = this.fullLevelModes.indexOf(this.mode) != -1;

					if( this.challengeModes.indexOf(this.mode) != -1 ) {
						this.timeLimit = 3000;
						//this.level=9;
					}

					if( this.fullLevelMode ) {
						this.passRateCorrect = 10;
					}
					
					// restore the level from long-living local storage
					var lsLevel = null;
					if( this.singleLevelMode ) {
						lsLevel = localStorage.getItem('level');
					// restore the level from session local storage
					} else {
						lsLevel = sessionStorage.getItem('level');
					}
					if(lsLevel) {
						this.level = parseInt(lsLevel);
					}
					
					// set custom level
					if( this.singleLevelMode ) {
						if (urlParams.has('level')) {
							this.level = parseInt(urlParams.get('level'));
							this.customLevel = true;
						}
					}
					
					if( [ 'ten-minus', 'full-minus' ].indexOf(this.mode) != -1 ) {
						this.mathOperator = '-';
						$('.site').addClass('minus');
						if( this.mode == 'ten-minus' ) {
							this.level= 10;
						} 
					} else if( [ 'full-multiply', 'half-multiply', 'challenge-multiply' ].indexOf(this.mode) != -1 ) {
						this.mathOperator = 'x';
						$('.site').addClass('multiply');
					}

					$('#nextLevelBtn').on('click', function(event){
						location.href=game.nextLevelUrl();
					});

					this.setLevel(this.level);
					console.log('Starting at level ' + this.level + ': ' + this.min1 + '-' + this.min2 + '-' + this.max2);

					$('#resetProgress').on('click', game.onResetProgress);

					$('#correctInRowLabel').html( this.correctInRowTxt.replace('%d', this.passRateInRow ) );
					$('.correct p').eq(1).html('<i class="fas fa-check empty"></i>'.repeat(this.passRateInRow));

					this.nextQuestion();

					this.setMenu();

				},


				setMenu: function() {
					$('.nav-item a[href="?mode='+game.mode+'"]').addClass('active');
				},

				onResetProgress: function() {
					if( ! confirm('Do you want to start from level 1?') ) {
						return;
					}	

					game.saveLevelProgress(1);
					location.reload();

				},

				toggle: function() {
					if( this.stopped ) {
						this.restart();
					} else {
						this.stop();
					}	

				},

				stop: function() {
					clearTimeout(this.nextQuestionInterval);
					clearTimeout(this.interval);
					this.stopTimer(true);
					this.stopped = true;
					$('.site > .container').css('backgroundColor', 'pink');
					$('#inResult').prop('disabled', true);
				},

				restart: function() {
					this.stopped = false;
					$('.site > .container').css('backgroundColor', 'white');
					$('#inResult').prop('disabled', false);
					this.nextQuestion();
				},

				onCorrect: function() {
					this.correct++;
					this.correctInRow++;
					this.correctInLevel++;

					$('.correct i.empty').first().removeClass('empty');
					$('.correctInLevel i.empty').first().removeClass('empty');
				},

				nextLevelUrl: function() {
					var nextLevel = this.level+1;
					return '?mode='+this.mode+'&level='+nextLevel;
				},


				setDeductionLevels: function() {
					if( [ 'ten-minus', 'full-minus' ].indexOf(this.mode) == -1 ) {
						return;
					}
					
					this.min2 = 0;
					this.max2 = this.min1;
					if( this.passRateInRow > this.max2+1 ) {
						this.passRateInRow = this.max2+1;
					}
					if( this.passRateCorrect > this.max2+1 ) {
						this.passRateCorrect = this.max2+1;
					}
					if( this.rememberedQuestionsCount > this.max2+1 ) {
						this.rememberedQuestionsCount = Math.floor(this.max2/2);
					}
				},

				setLevel: function (level) {
					this.correctInLevel = 0;
					this.levelTimer = 0.0;
					if( this.fullLevelMode) {
						this.min1 = this.max1 = level;
						this.min2 = 1;
						this.max2 = 10;

						this.setDeductionLevels();

						$('#levelLabel').html( this.levelLabelTxt.replace('%s', level ) );
						$('.correctInLevel .fa-check').addClass('empty');

						$('#correctInLevelLabel').html( this.correctInLevelTxt.replace('%d', this.passRateCorrect ) );
						$('.correctInLevel p').eq(1).html('<i class="fas fa-check empty"></i>'.repeat(this.passRateCorrect));
						$('.correctInLevel').removeClass('d-none');

						// half-level mode
					} else {
						this.min1 = this.max1 = parseInt(Math.ceil(level / 2));
						this.min2 = 5;
						this.max2 = 10;
						if (level % 2) {
							this.min2 = 1;
							this.max2 = 5;
						}
						levelText = this.min1.toString() + '('+this.min2 + '-'+this.max2+')';
						$('#levelLabel').html( this.levelLabelTxt.replace('%s', levelText ) );
					}

				
					this.saveLevelProgress();

					var $stars = $('p.level i');
					// reset all to gray full star
					$stars.find('.fa-star-half-alt').removeClass('fa-star-half-alt').addClass('fa-star').css('color', '#e9ecef');
					$stars.slice(0, this.min1).css('color', '#f98297');
					if (! this.fullLevelMode && this.min2 == 1) {
						$stars.eq(this.min1 - 1).removeClass('fa-star').addClass('fa-star-half-alt');
					}
				},

				saveLevelProgress: function(level) {

					if( typeof level == 'undefined' ) {
						level = this.level;
					}
						// save progress
					if( this.singleLevelMode ) {
						localStorage.setItem('level', level);
					} else {
						sessionStorage.setItem('level', level);
					}

				},

				startTimer: function () {
					this.answerTimeStart = performance.now();
					this.progressInterval = setInterval(function () {
						var p = game.progressEl;
						game.timer = game.timer + game.progressTick;
						var w = Math.floor(game.timer / game.timeLimit * 100.0);
						if (w > 100) {
							w = 100;
						}
						//console.log(w);
						if (w == 100) {
							p.addClass('bg-danger');
						}
						p.css('width', w.toString() + "%");
					}, this.progressTick);
				},

				stopTimer: function (reset) {
					clearInterval(this.progressInterval);
					this.timer = 0.0;
					if (reset) {
						this.progressEl.css('width', '0%');
					}
				},

				randomNumber: function (min, max) {
					return Math.floor((Math.random() * (max - min)) + min);
				},


				shuffleArray: function (array) {
					var currentIndex = array.length, temporaryValue, randomIndex;

					// While there remain elements to shuffle...
					while (0 !== currentIndex) {

						// Pick a remaining element...
						randomIndex = Math.floor(Math.random() * currentIndex);
						currentIndex -= 1;

						// And swap it with the current element.
						temporaryValue = array[currentIndex];
						array[currentIndex] = array[randomIndex];
						array[randomIndex] = temporaryValue;
					}

					return array;
				},

				generateQuestonsPool: function() {
					for( var i=this.min2; i<this.max2+1; i++) {
						this.questionsPool.push(i);
					}
					console.debug('clean',this.questionsPool);
					console.debug('last ones',this.lastQuestions);

					var questionsLeft = _.difference(this.questionsPool, this.lastQuestions);
					if( questionsLeft.length == 0 ) {
						this.lastQuestions = [];
						console.warn('All available questions were already answered! Flushing the last question memory.');
					}
					this.questionsPool = this.shuffleArray(this.questionsPool);
					
				},

				randomQuestionFromPool: function() {
					do {
						if( this.questionsPool.length == 0 ) {
							this.generateQuestonsPool();
						}

						this.number2 = this.questionsPool.pop();
						this.number1 = this.min1;
						this.question = this.number1 + ' ' + this.mathOperator + ' ' + this.number2 + ' = ?';
					} while (this.lastQuestions.indexOf(this.number2) != -1);
				},

				nextQuestion: function () {
					if( this.stopped ) {
						return;
					}
					this.randomQuestionFromPool();

					if( this.mathOperator == '+' ) {
						this.expectedAnswer = this.number1 + this.number2;
					} else if( this.mathOperator == 'x' ) {
						this.expectedAnswer = this.number1 * this.number2;
					} else {
						this.expectedAnswer = this.number1 - this.number2;
					}
					this.rememberQuestion();
					
					this.feedbackEl.hide();
					this.questionEl.html(this.question);
					this.resultInput.prop('disabled', false);
					this.resultInput.val('');
					this.questionsNoEl.html(this.askedQuestions);
					this.askedQuestions++;
					this.answered = false;
					this.progressEl.removeClass('bg-danger');
					this.failed = false;
					this.resultInput.focus();
					this.startTimer();

					this.interval = setTimeout(function () { game.fail() }, game.timeLimit);
				},


				onAnswer: function (event) {
					if( this.failed ) {
						return;
					}
					// don't allow stopping here as
					// user could keep stopping until getting the question s/he knows the answer
					/*
					if( event.which == 27 ) {
							this.toggle();
					}
					*/
					clearTimeout(this.nextQuestionInterval);
					this.answered = true;
					console.debug('call onAnswer');
					clearTimeout(this.interval);
					this.stopTimer(true);
					this.checkResult();

				},

				resetCorrectInRow: function() {
					this.correctInRow = 0;
					$('.correct .fa-check').addClass('empty');
				},

				checkResult: function () {
					this.lastAnswerTime = performance.now() - this.answerTimeStart;
					var inRes = this.resultInput.val();
					// there is no debounce after pressing 2nd character
					if( inRes.length == 1 ) {
						this.lastAnswerTime -= this.answerDebounce;
					}
					this.lastAnswerTime /= 1000;
					this.levelTimer += this.lastAnswerTime;
					console.log('level timer = '+this.levelTimer);
					var answer = parseInt(inRes);
					if (this.logAnswers) {
						console.log('[answer] ' + this.question.replace('?', answer) + ' in '+this.lastAnswerTime+'s');
					}
					this.resultInput.prop('disabled', true);
					if (answer == this.expectedAnswer) {
						this.onCorrect();
					} else {
						if( this.correctInRow < this.passRateInRow ) {
							this.resetCorrectInRow();
						}
					}
					this.showFeedback(answer == this.expectedAnswer);

					this.correctNoEl.html(this.correct);
					this.correctInRowEl.html(this.correctInRow);
					if (this.correctInRow < this.passRateInRow || ( this.passRateCorrect > 0 && this.correctInLevel < this.passRateCorrect )) {
						setTimeout(function () { game.nextQuestion(); }, 2000);
					} else {
						if (this.singleLevelMode) {
							this.passTest();
						} else if ( this.challengeModes.indexOf(this.mode) != -1 ) {
							if (this.level == 10 ) {
								this.passTest();
								return;
							}

							// level up
							this.resetCorrectInRow();
							this.level = this.level + 1;
							this.levelTimer = Math.round(this.levelTimer*100)/100;
							$('#toastLevelCompleted .toast-body').html(this.levelCompletedToastTxt.replace('%d', this.levelTimer));
							$('#toastLevelCompleted').toast('show');
							this.setLevel(this.level);
							setTimeout(function () { game.nextQuestion(); }, 2000);
						}
					}
				},

				fail: function () {
					this.stopTimer(false);
					this.failed = true;
					console.debug('call fail');
					if( this.correctInRow < this.passRateInRow ) {
						this.resetCorrectInRow();
					}
					this.correctInRowEl.html('0');
					if (this.logAnswers) {
						console.log('[failed] ' + this.question);
					}
					this.showFeedback(false);
					this.nextQuestionInterval = setTimeout(function () {
						game.progressEl.css('width', '0%');
						setTimeout(function () { game.nextQuestion(); }, 400);
					}, 2000);
				},


				passTest: function () {
					var passedId = this.challengeModes.indexOf(this.mode) != -1 ? '#modalPassedRobloxChallenge' : '#modalPassedLevel';
					clearInterval(this.progressInterval);
					if( this.mode == 'ten-minus' ) {
						$(passedId+' p').slice(1,3).hide();
					}
					$(passedId).modal('show');
				},

				showFeedback: function (isCorrect) {
					this.questionEl.html(this.question.replace('?', this.expectedAnswer));
					var $success = this.feedbackEl.find('.alert-success');
					var goldAnswer = isCorrect && this.lastAnswerTime < this.goldAnswerSpeed;
					$success.toggle(isCorrect);
					this.feedbackEl.find('.alert-danger').toggle(!isCorrect);
					$success.find('svg.bi-award-fill').toggle(goldAnswer);
					$success.find('svg.bi-emoji-smile').toggle(!goldAnswer);
					if(goldAnswer) {
						this.goldAnswersInRow++;
						if(this.goldAnswersInRow > 2) {
							$('#toastOnFire').toast('show');
							this.goldAnswersInRow = 0;
						}
					} else {
						this.goldAnswersInRow = 0;
					}
					this.feedbackEl.show();
				},

				debounce: function debounce(func, wait, immediate, maxCalls) {
					var timeout;
					var callsCounter = 0;
					return function () {
						var context = this, args = arguments;
						var later = function () {
							timeout = null;
							if (!immediate) { 
								callsCounter=0;
								func.apply(context, args);
							}
						};
						callsCounter++;
						// console.debug('[debounce] calls counter = '+callsCounter);
						if( maxCalls ) {
							immediate = false;
							if( callsCounter == maxCalls ) {
								timeout = null;
								immediate = true;
							}
						}
						// console.debug('[debounce] immediate='+immediate+'; timeout='+timeout);
						var callNow = immediate && !timeout ;
						clearTimeout(timeout);
						timeout = setTimeout(later, wait);
						if (callNow) { 
							callsCounter=0;
							func.apply(context, args);
						}
					};
				},

				rememberQuestion: function () {
					if( this.rememberedQuestionsCount == 0 ) {
						return;
					}
					if (this.lastQuestions.length >= this.rememberedQuestionsCount) {
						this.lastQuestions.shift();
					}
					this.lastQuestions.push(this.number2);
				}

			};
			game.init();

		})
	</script>
</body>

</html>